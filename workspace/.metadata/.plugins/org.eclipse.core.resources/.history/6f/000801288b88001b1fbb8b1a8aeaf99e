<%@page import="java.util.TimeZone"%>
<%@page import="java.util.Locale"%>
<%@page import="kr.or.ddit.enumpkg.MimeType"%>
<%@page import="java.util.Calendar"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<!-- <meta http-equiv="Refresh" content="1"> -->
<title>05/autoRequest.jsp</title>
</head>
<body>
<form>
	<select name="loc" >
		<%
		
		 	for(Locale tmp : Locale.getAvailableLocales()){
		 		String dl = tmp.getDisplayLanguage(tmp);
		 		String dc = tmp.getDisplayCountry(tmp);
		 		if(dl.isEmpty()&&dc.isEmpty()) continue;
		 		
		 		%>
		 		<option  value="<%=tmp.toLanguageTag()%>"><%=String.format("%s[%s]",dl,dc) %></option>
		 		<%
		 		
		 	}
		%>
	</select>
</form>
<select name ="timeZone">
	<%
		for(String tmpId:TimeZone.getAvailableIDs()){
			TimeZone tmpZone =TimeZone.getTimeZone(tmpId);
			%>
			<option values="<%=tmpId%>"><%=tmpZone.getDisplayName() %></option>
			<%
		}
	%>
</select>
<script type="text/javascript">
 $("[name='loc']").on('change',function(event){
	 this.form.submit();
 });

</script>
매 1초마다 비동기 요청을 발생시키고, 클라이언트에게 사용 언어를 입력받을것
클라이언트에게 가져오고싶은 시간대를 입력받을 것
	<h4>Auto Request header</h4>
	1) Refresh 헤더를 이용한 방식.
	<%-- <%
		response.setIntHeader("Refresh", 1);
	%> --%>
	2) html 의 meta 태그 이용
	<!-- <meta http-equiv="Refresh" content="1"> -->
	3) JS 의 스케쥴링 함수 이용 : setTimeout, setInterval
	<h4>현재 서버의 시각 :<span id="serverTimer"></span></h4>
<script type="text/javascript"
	src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
	var span = document.querySelector("#countdown");
	const INITTIME = 10;
	var datas = $("[name='loc']");
	var timer =INITTIME;
	var serverTimer = $("#serverTimer");
	
	var jobid = setInterval(() => {
		data ={
				data: datas.val()
		}
		$.ajax({
			url : "<%=request.getContextPath()%>/04/serverTime",
			data : data,
			dataType : 'text',
			success : function (resp) {
				serverTimer.text(resp)
			},
			error : function(xhr, error, msg) {
				console.log(xhr);
				console.log(error);
				console.log(msg);
			}
		})
	}, 1000);
	
</script>
</body>
</html>