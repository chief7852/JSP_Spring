<%@page import="java.util.Date"%>
<%@ page import="java.util.Locale" %>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>12/jstlDesc.jsp</title>
<style type="text/css">
.green {
	background-color: green;
}

.blue {
	background-color: blue;
}
</style>
</head>
<body>
	<h4>JSTL(Jsp Standard Tag Library)</h4>
	<select onchange="location.href='?lang=' + this.value;" >
	<c:forEach items="${Locale.getAvailableLocales()}" var="tmp">
		
			<option value="${tmp.toLanguageTag() }">${tmp.displayLanguage }[${tmp.displayCountry }]</option>
		
	</c:forEach>
	</select>
	<pre>
	: 커스텀 태그 라이브러리 (server side)
	
	<prefix:tagname arrtributes />
	1. core 
		1) EL 변수(속성) 지원 : set, remove
		<c:set var="test" value="테스트" scope="request" />
		<!-- (기본은 페이지 스코프에 들어가있음) -->
		${requestScope.test }, ${requestScope["test"] }
		<c:remove var="test" scope="request" />
		<!-- 스코프를 안쓰면 모든 스코프에 test를 다지워버린다 -->
		${requestScope.test }, ${requestScope["test"] }
		2) 흐름 제어 : 
			조건문 : if
			<c:if test="${empty test }">
				test없음.
			</c:if>
			삼항:${empty test ? "없다" : "있다" }
			다중조건문 : choose~when~otherwise
			<c:choose>
				<c:when test="${ empty test}">없다</c:when>
				<c:when test="${not empty test}">있다</c:when>
			</c:choose>
			반복문 : forEach
			향상된 for문 : for(block variable : collection) : items, var
			<%-- <c:forEach items="" var="">
			
			</c:forEach> --%>
			일반 for문 : for(선언절;조건절;증감절) : var, begin, end, step ...(주의사항 step은 0보다 커야한다, 1인경우 생략가능)
			LoopTagStatus(varStatus) 프로퍼티 : index(var속성의 값), count(몇번째 반복인지)
											first, last
			<c:forEach var="i" begin="1" end="5" step="2" varStatus="vs">
				${i } - ${vs.count } 번째 반복,${vs.first },${vs.last }
				
			</c:forEach>
			token : 문장의 구성요소중 의미를 부여할수 있는 가장 작은 단위 (inti=4;, int i = 4)
			<c:forTokens items="아버지 가방에 들어가신다" delims=" " var="token">
				${token }
			</c:forTokens>
			<!-- 문자열 임에도 연산자 중심적인 EL변수의 특성에 의해 계산가능 -->
			<c:forTokens items="100,200,300" delims="," var="number">
				${number *3 }
			</c:forTokens>
		3) URL (재)처리 : url	(클라이언트에서 사용할수있는 절대경로를 만들어줌)(쿠키트레킹체크해서 쿠키가 없더라도 세션을 유지할수있게해줌)
		<c:url var="memberList" value="/member/memberList.do">
			<c:param name="page" value="2"></c:param>	<!-- 페이지만들어줌 -->
		</c:url>
		<a href="${cPath }/member/memberList">회원목록의 2페이지</a>
		<a href="${memberList }">회원목록의 2페이지</a>		
		4) 기타 : import, out
		크롤링에 활용가능
		<%-- <c:import url="https://www.naver.com" var="naver"/>
		<c:out value="${naver }" escapeXml="${false }"/><!-- naver 소스를 들고옴 --> --%>
	2. fmt(locale 지원)
		1) 언어처리 : serLocale , message
			- 언어 결정
			- 메시지 번들 작성(properties)
			- locale 결정
			<c:if test="${empty param.lang }">
				<c:set var="locale" value="${pageContext.request.locale}"/>			
			</c:if>
			<c:if test="${not empty param.lang }">
				<c:set var="locale" value="${param.lang }"/>
			</c:if>
			<fmt:setLocale value="${locale}"/>
			- 메시지 출력 : 번들로딩, 메시지 사용.
			<fmt:bundle basename="kr.or.ddit.messages.message">
				<fmt:message key="bow"/>
			</fmt:bundle>
		2) 메시지 형식 처리
			- parsing : parseNumber, parseDate(문자를 날짜로바꿔줌)
			- formatting : formatNumber(숫자를 문자로), formatDate(날짜를 문자로) 
			<%-- <fmt:setLocale value="en_US"/><!-- 파싱할 언어  --> --%>
			<fmt:formatNumber value="30000" type="currency" var="money"/><!-- 30,000 type="currency"$30,000.00  -->
			<!-- 파싱 -->
			<fmt:parseNumber value="${money }" type="currency" var="number"></fmt:parseNumber>
			${number *10 }
			<!-- 다시 formatting -->
			<fmt:formatDate value="<%=new Date() %>" type="both" dateStyle="short" var="datestr" />
			${datestr }
			<!-- datestr는 날짜데이터가아니라 그냥 문자열이라서 밀리세컨드만 출력불가능  formatting해야함 -->
			<fmt:parseDate value="${datestr }" type="both" dateStyle="short" var="dateObj"/>
			${dateObj.time }
	3. fn (String에서 가지고있던 메소드들을 본따서 만듬)
		${fn:indexOf("abcde", "a") }
		<!-- stringtokenize 반대 (조립해줌) -->
		<c:set var="array" value='<%= new String[]{"value1","value2"} %>'></c:set>
		${fn:join(array,"|") }
</pre>
	<!-- 2_9단 까지의 구구단 출력 -->
	<!-- 3번째 줄은 back color 초록 -->
	<!-- 짝수단 -->
	<!-- 첫번째 컬럼과 5번째컬럼 -->
	<%-- <table>

<c:forEach var="dan" begin="2" end="9" step="2" varStatus="vs1">
<tr class="${vs1.count eq 3 ? 'green':'normal'}">
	<c:forEach var="mul" begin="1" end="9"  varStatus="vs2">
		<c:choose>
			<c:when test="${vs2.first or vs2.last }">
				<c:set var="clz" value="blue"/>
			</c:when>
			<c:otherwise>
				<c:set var="clz" value="normal"/>
			</c:otherwise>
				<td class="${clz }" >${dan } * ${mul } = ${dan*mul}</td>
		</c:choose>
	</c:forEach>
</tr>
</c:forEach>
</table>
 --%>



</body>

</html>